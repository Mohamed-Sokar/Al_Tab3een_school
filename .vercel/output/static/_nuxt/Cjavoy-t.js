import{ae as q,v as g,g as y}from"./Bdt3oPQx.js";import{u as _}from"./BV0LrqSL.js";import{u as x}from"./CnqViFtj.js";import{a as c}from"./CdmufGkO.js";const Q=q("quran_classes",()=>{const i=_(),{toastError:o,toastSuccess:l}=x(),n=g([]),a=g(!1),v=y(()=>n.value),f=y(()=>n.value.map(t=>{const s=i.sortedStudents.filter(e=>{var r,u;return((r=e.quran_class)==null?void 0:r.title)===t.title&&((u=e.quran_class)==null?void 0:u.group)===t.group}).length;return{...t,studentsCount:s}})),S=async()=>{a.value=!0;try{const{data:t}=await c.get("/quran_classes");console.log(t),n.value=t,l({title:"تم تحميل الصفوف بنجاح"})}catch(t){o({title:"حدث مشكلة أثناء تحميل الصفوف",description:t instanceof Error?t.message:typeof t=="string"?t:JSON.stringify(t)})}finally{a.value=!1}},m=async t=>{a.value=!0;try{const{data:s}=await c.post("/quran_classes",t);l({title:":تم إضافة الصف بنجاح"}),console.log(s),n.value.unshift({...t})}catch(s){o({title:"حدث مشكلة في إضافة الصف",description:s instanceof Error?s.message:typeof s=="string"?s:JSON.stringify(s)})}finally{a.value=!1}},C=async t=>{try{a.value=!0,await c.delete(`quran_classes/${t}`),l({title:":تم حذف المستوى بنجاح"});const s=d(t);n.value.splice(s,1)}catch(s){o({title:"حدث مشكلة في حذف المستوى",description:s instanceof Error?s.message:typeof s=="string"?s:JSON.stringify(s)})}finally{a.value=!1}},h=async(t,s)=>{try{a.value=!0;const{data:e}=await c.put(`quran_classes/${t}`,s);l({title:":تم تحديث بيانات الصف بنجاح"}),console.log(e);const r=d(t),u=p(t);n.value[r]={...u,...s}}catch(e){o({title:"حدث مشكلة في تعديل بيانات الصف",description:e instanceof Error?e.message:typeof e=="string"?e:JSON.stringify(e)})}finally{a.value=!1}},p=t=>n.value.find(s=>s.id===t),d=t=>n.value.findIndex(s=>s.id===t);return{loading:a,classesData:v,classesWithStudentsCount:f,fetchClasses:S,addClass:m,updateClass:h,deleteClass:C,getSpecificClass:p,getSpecificClassIndex:d,classStudentsCount:t=>{var s;return(s=f.value.find(e=>e.title===t))==null?void 0:s.studentsCount},updateQuranClassForStudents:async(t,s)=>{try{a.value=!0;const{data:e}=await c.put("/quran_classes/update-quran-class",{studentIds:t,classId:s});console.log(e),l({title:"تم نقل الطلاب للصف القرآني الجديد بنجاح"}),i.studentsData=i.studentsData.map(r=>t.includes(r.id||"")?{...r,academic_class_id:s}:r)}catch{o({title:"فشل في نقل الطلاب"})}finally{a.value=!1}}}});export{Q as u};
