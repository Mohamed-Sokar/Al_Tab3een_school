import{ae as _,v as m,g}from"./Bdt3oPQx.js";import{u as x}from"./BV0LrqSL.js";import{u as E}from"./CnqViFtj.js";import{a as l}from"./CdmufGkO.js";const F=_("academic_classes",()=>{const u=x(),{toastError:i,toastSuccess:o}=E(),c=m([]),a=m(!1),y=g(()=>c.value),f=g(()=>c.value.map(t=>{const e=u.sortedStudents.filter(s=>{var n,r;return((n=s.academic_class)==null?void 0:n.title)===t.title&&((r=s.academic_class)==null?void 0:r.group)===t.group}).length;return{...t,studentsCount:e}})),v=async()=>{a.value=!0;try{const{data:t}=await l.get("academic_classes");console.log(t),c.value=t,o({title:"تم تحميل الصفوف بنجاح"})}catch(t){i({title:"حدث مشكلة أثناء تحميل الصفوف",description:t instanceof Error?t.message:typeof t=="string"?t:JSON.stringify(t)})}finally{a.value=!1}},S=async t=>{a.value=!0;try{const{data:e}=await l.post("academic_classes",t);o({title:":تم إضافة الصف بنجاح"}),console.log(e),c.value.unshift({...t})}catch(e){i({title:"حدث مشكلة في إضافة الصف",description:e instanceof Error?e.message:typeof e=="string"?e:JSON.stringify(e)})}finally{a.value=!1}},C=async t=>{try{a.value=!0,await l.delete(`academic_classes/${t}`),o({title:":تم حذف المستوى بنجاح"});const e=d(t);c.value.splice(e,1)}catch(e){i({title:"حدث مشكلة في حذف المستوى",description:e instanceof Error?e.message:typeof e=="string"?e:JSON.stringify(e)})}finally{a.value=!1}},h=async(t,e)=>{try{a.value=!0;const{data:s}=await l.put(`academic_classes/${t}`,e);o({title:":تم تحديث بيانات الصف بنجاح"}),console.log(s);const n=d(t),r=p(t);c.value[n]={...r,...e}}catch(s){i({title:"حدث مشكلة في تعديل بيانات الصف",description:s instanceof Error?s.message:typeof s=="string"?s:JSON.stringify(s)})}finally{a.value=!1}},p=t=>c.value.find(e=>e.id===t),d=t=>c.value.findIndex(e=>e.id===t);return{loading:a,classesData:y,classesWithStudentsCount:f,fetchClasses:v,addClass:S,updateClass:h,deleteClass:C,getSpecificClass:p,getSpecificClassIndex:d,classStudentsCount:t=>{var e;return(e=f.value.find(s=>s.title===t))==null?void 0:e.studentsCount},updateAcademicClassForStudents:async(t,e)=>{try{a.value=!0;const{data:s}=await l.put("academic_classes/update-academic-class",{studentIds:t,classId:e});console.log(s),o({title:"تم نقل الطلاب للصف الدراسي الجديد بنجاح"}),u.studentsData=u.studentsData.map(n=>t.includes(n.id||"")?{...n,academic_class_id:e}:n)}catch{i({title:"فشل في نقل الطلاب"})}finally{a.value=!1}}}});export{F as u};
