import{ae as w,v,g as d}from"./Bdt3oPQx.js";import{u as x}from"./BV0LrqSL.js";import{u as C}from"./CnqViFtj.js";import{a as r}from"./CdmufGkO.js";const T=w("levels",()=>{const f=x(),{toastError:n,toastSuccess:o}=C(),a=v([]),s=v(!1),p=d(()=>a.value),u=d(()=>a.value.map(e=>{const t=f.studentsData.filter(l=>l.level===e.title).length;return{...e,studentsCount:t}})),g=async()=>{s.value=!0;try{const{data:e}=await r.get("/levels");console.log(e),a.value=e,o({title:"تم تحميل المستويات بنجاح"})}catch(e){throw n({title:"حدث مشكلة أثناء تحميل المستويات",description:e.message}),Error(e instanceof Error?e.message:String(e))}finally{s.value=!1}},m=async e=>{s.value=!0;try{const{data:t}=await r.post("/levels",e);o({title:":تم إضافة المستوى بنجاح"}),console.log(t),a.value.unshift({...e})}catch(t){throw n({title:"حدث مشكلة في إضافة المستوى",description:t.message}),Error(t instanceof Error?t.message:String(t))}finally{s.value=!1}},S=async e=>{try{s.value=!0,await r.delete(`levels/${e}`),o({title:":تم حذف المستوى بنجاح"});const t=c(e);a.value.splice(t,1)}catch(t){n({title:"حدث مشكلة في حذف المستوى",description:t.message})}finally{s.value=!1}},y=async(e,t)=>{try{s.value=!0;const{data:l}=await r.put(`levels/${e}`,t);o({title:":تم تحديث بيانات المستوى بنجاح"}),console.log(l);const h=c(e),L=i(e);a.value[h]={...L,...t}}catch(l){n({title:"حدث مشكلة في تعديل بيانات المستوى",description:l.message})}finally{s.value=!1}},i=e=>a.value.find(t=>t.id===e),c=e=>a.value.findIndex(t=>t.id===e);return{loading:s,levelsData:p,levelsWithStudentsCount:u,fetchLevels:g,addLevel:m,updateLevel:y,deleteLevel:S,getSpecificLevel:i,getSpecificLevelIndex:c,levelStudentsCount:e=>{var t;return(t=u.value.find(l=>l.title===e))==null?void 0:t.studentsCount}}});export{T as u};
