import{ae as $,v as i,g as l}from"./Bdt3oPQx.js";import{u as D}from"./CnqViFtj.js";import{a as c}from"./CdmufGkO.js";const A=$("payments",()=>{const{toastSuccess:s,toastError:o}=D(),a=i([]),r=i(!1),d=i(Math.random()),m=async()=>{r.value=!0;try{const{data:t}=await c.get("/payments");console.log(t),a.value=t,s({title:"تم تحميل المدفوعات بنجاح"}),d.value=Math.random()}catch(t){throw o({title:"حدث مشكلة أثناء تحميل المدفوعات"}),Error(t instanceof Error?t.message:String(t))}finally{r.value=!1}},v=async t=>{r.value=!0;try{const{data:e}=await c.post("/payments",{...t});s({title:":تم إضافة الدفعة بنجاح"}),console.log(e),(a.value||[]).unshift({...t,date:t.date?new Date(t.date).toISOString().split("T")[0]:void 0})}catch(e){throw o({title:"حدث مشكلة في إضافة الدفعة"}),Error(e instanceof Error?e.message:String(e))}finally{r.value=!1}},g=async t=>{try{r.value=!0,await c.delete(`payments/${t}`),s({title:":تم حذف الدفعة بنجاح"});const e=u(t);(a.value||[]).splice(e,1)}catch{o({title:"حدث مشكلة في حذف الدفعة"})}finally{r.value=!1}},p=async(t,e)=>{try{r.value=!0;const{data:n}=await c.put(`payments/${t}`,e);s({title:":تم تحديث بيانات الدفعة بنجاح"}),console.log(n);const x=u(t),I=y(t);(a.value||[])[x]={...I,...e}}catch(n){throw o({title:"حدث مشكلة في تعديل بيانات الدفعة"}),Error(n instanceof Error?n.message:String(n))}finally{r.value=!1}},h=async t=>{try{r.value=!0;const{data:e,status:n}=await c.get(`payments/${t}`);if(n!==200)throw o({title:"حدث مشكلة في جلب الدفعة"}),Error("مشكلة في السيرفر");return s({title:":تم جلب الدفعة بنجاح"}),e[0]}catch{}finally{r.value=!1}},y=t=>(a.value||[]).find(e=>e.id==t),u=t=>(a.value||[]).findIndex(e=>e.id==t),f=l(()=>a.value),P=l(()=>[...f.value??[]].sort((t,e)=>(t.amount??0)-(e.amount??0))),S=l(()=>(a.value||[]).reduce((t,e)=>e.type==="وارد"?t+=e.amount:t+=0,0)),w=l(()=>a.value||[]),E=l(()=>(a.value||[]).reduce((e,n)=>n.type==="صادر"?e+=n.amount:e+=0,0));return{payments:a,loading:r,tableKey:d,fetchPayments:m,addPayment:v,deletePayment:g,updatePayment:p,getSpecificPayment:y,getSpecificPaymentIndex:u,getPaymentById:h,totalPayments:w,totalIncome:S,totalExpense:E,paymentsData:f,sortedPayment:P}});export{A as u};
